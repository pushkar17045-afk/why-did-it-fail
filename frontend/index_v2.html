<!DOCTYPE html>
<html>
<head>
  <title>Why Did It Fail?</title>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 0 20px;
    }
    <input type="file" id="fileInput" accept=".txt,.log" />
<p style="font-size: 14px; color: #555;">
You can paste logs or upload a .log / .txt file.
</p>
    textarea {
      width: 100%;
      height: 220px;
      font-family: monospace;
    }
    button {
      margin-top: 12px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    .result {
      margin-top: 24px;
      padding: 16px;
      border-left: 4px solid #444;
      background: #f9f9f9;
    }
  </style>
</head>
<body>

<h1>Why Did It Fail?</h1>
<p>Paste system logs below and get a clear explanation of what failed first.</p>

<textarea id="logs" placeholder="Paste logs here..."></textarea>
<br>
<button onclick="analyze()">Analyze</button>

<div id="output" class="result" style="display:none;"></div>

<script>
async function analyze() {
  const output = document.getElementById("output");
  const textarea = document.getElementById("logs");
  const fileInput = document.getElementById("fileInput");

  let logs = textarea.value;

  if (fileInput.files.length > 0) {
    logs = await fileInput.files[0].text();
  }

  if (!logs.trim()) {
    output.style.display = "block";
    output.innerHTML = "Please paste logs or upload a file.";
    return;
  }

  output.style.display = "block";
  output.innerHTML = "Analyzing logsâ€¦ this may take a moment.";

  try {
    const res = await fetch(
      "https://YOUR-BACKEND.onrender.com/analyze",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ logs })
      }
    );

    const data = await res.json();

    output.innerHTML = `
      <strong>${data.summary}</strong><br><br>
      ${data.root_cause ? `<pre>${data.root_cause}</pre>` : ""}
      <br>
      Confidence: <b>${data.confidence}</b>
      <br><br>
      <small>${data.note || ""}</small>
    `;
  } catch (e) {
    output.innerHTML = "Something went wrong while analyzing the logs.";
  }
}
</script>

</body>
</html>
